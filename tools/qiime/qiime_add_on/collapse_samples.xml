<tool id="qiime_collapse_samples" name="Collapse samples" version="@WRAPPER_VERSION@.0">

    <description>Collapse samples in a BIOM table and mapping file</description>

    <macros>
        <import>macros.xml</import>
    </macros>

    <expand macro="requirements"/>

    <version_command>collapse_samples.py --version</version_command>

    <command detect_errors="aggressive"><![CDATA[
    ]]></command>

    <inputs>
        <param argument="--input_biom_fp" type="data" format="biom1" label="Input biom table" help="The biom table containing the samples to be collapsed" />
        <param argument="--mapping_fp" type="data" format="tabular" label="Input mapping file" help="The sample metadata mapping file" />
        <param argument="--collapse_mode" type="select" label="Collapse mode to use" help="The mechanism for collapsing counts within groups">
            <option value="sum" selected="true">sum</option>
            <option value="mean">mean</option>
            <option value="random">random</option>
            <option value="median">median</option>
            <option value="first">first</option>
        </param>
        <param argument="--normalize" type="boolean" label="Do you want to normalize observation counts to relative abundances ?" truevalue="--normalize" falsevalue="" checked="False" help="When this option is used the counts within each sample sum to 1.0" />
        <repeat name="collapse_fields_repeat" title="New field to collapse data on" help="You must specify at least one field to collapse data on">
            <param argument="--collapse_fields" type="text" label="Name of the field" value="" help="Enter the name of one of the column of your mapping file" />
        </repeat>
    </inputs>

    <outputs>
        <data name="output_biom_fp" format="biom1" label="${tool.name} on ${on_string}: Collapsed biom table"/>
        <data name="output_mapping_fp" format="tabular" label="${tool.name} on ${on_string}: Collapsed mapping file"/>
    </outputs>

    <tests>
    </tests>

    <help><![CDATA[
    ]]></help>

    <citations>
        <expand macro="citations"/>
    </citations>
</tool>
