<tool id="qiime_alpha_diversity" name="Calculate alpha diversity" version="1.9.1">
    <description>on each sample in an otu table</description>

    <macros>
        <import>macros.xml</import>
    </macros>

    <expand macro="requirements" />

    <version_command><![CDATA[
        alpha_diversity.py --version
    ]]>
    </version_command>

    <command>
<![CDATA[
        #set $chosen_metrics = str( $metrics ).split( "," )

        alpha_diversity.py 
            -i $input_table 
            -o $alpha_diversity

            -m $metrics

            #if "PD_whole_tree" in $chosen_metrics:
                -t $tree_file
            #end if

]]>
    </command>

    <inputs>
        <param name="input_table" type="data" format="tabular,txt,tsv,biom" 
            label="OTU table" help="(-i/--input_path)" 
            multiple="True"/>

        <param name="metrics" type="select" multiple="True" label="Alpha-diversity 
            metric(s) to use" help="(-m/--metrics)" 
            display="checkboxes">
            <option value="ace">ACE (Abundance-based Coverage Estimator) metric</option>
            <option value="berger_parker_d">Berger-Parker dominance</option>
            <option value="brillouin_d">Brillouin index of alpha diversity</option>
            <option value="chao1" selected="true">chao1 richness estimator</option>
            <option value="chao1_ci">chao1 confidence interval</option>
            <option value="dominance">Dominance</option>
            <option value="doubles">Number of double occurrences (doubletons)</option>
            <option value="enspie">ENS_pie alpha diversity measure</option>
            <option value="equitability">Equitability</option>
            <option value="esty_ci">Esty’s CI</option>
            <option value="fisher_alpha">Fisher’s alpha</option>
            <option value="gini_index">Gini index</option>
            <option value="goods_coverage">Good’s coverage of counts</option>
            <option value="heip_e">Heip’s evenness measure</option>
            <option value="kempton_taylor_q">Kempton-Taylor Q index of alpha diversity</option>
            <option value="margalef">Margalef’s richness index</option>
            <option value="mcintosh_d">McIntosh dominance index D</option>
            <option value="mcintosh_e">McIntosh’s evenness measure E</option>
            <option value="menhinick">Menhinick’s richness index</option>
            <option value="michaelis_menten_fit">Michaelis-Menten fit to rarefaction curve of observed OTUs</option>
            <option value="observed_otus">Number of distinct OTUs</option>
            <option value="observed_species" selected="true">Number of distinct species</option>
            <option value="osd">Observed OTUs, singles, and doubles</option>
            <option value="simpson_reciprocal">simpson_reciprocal</option>
            <option value="robbins">Robbins’ estimator for the probability of unobserved outcomes</option>
            <option value="shannon">Shannon entropy of counts</option>
            <option value="simpson">Simpson’s index</option>
            <option value="simpson_e">Simpson’s evenness measure E</option>
            <option value="singles">Number of single occurrencesles</option>
            <option value="strong"> Strong’s dominance index</option>
            <option value="PD_whole_tree">Phylogenetic diversity</option>
        </param>
        
        <param  name="tree_file" type="data" label="Newick tree (optional, except
            for PD_whole_tree metric" help="(-t/--tree_path)" optional="True"/>
    </inputs>

    <outputs>
        <data name="alpha_diversity" format="tabular" 
            from_work_dir="alpha_diversity/alpha_div.txt" 
            label="${tool.name} on ${on_string}: Alpha diversity" />
    </outputs>

    <tests>
        <test>
            <param name="input_table" value="pick_open_reference_otus_otu_table.txt"/>
            <param name="metrics" value="chao1,observed_species" />
            <output name="alpha_diversity" value="" />
        </test>
    </tests>

    <help><![CDATA[

**What it does?**

This tool calculates alpha diversity, or within-sample diversity, using an
OTU table.

The resulting file(s) is a tab-delimited text file, where the columns correspond 
to alpha diversity metrics and the rows correspond to samples and their calculated 
diversity measurements. When a folder is given as input (-i), the script processes 
every otu table file in the given folder, and creates a corresponding file in the 
output directory.

More information about this tool is available on 
`QIIME documentation <http://qiime.org/scripts/alpha_diversity.html>`_.
    ]]>
    </help>

    <citations>
        <expand macro="citations" />
    </citations>
</tool>
