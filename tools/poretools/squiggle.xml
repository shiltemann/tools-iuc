<tool id="poretools_squiggle" name="squiggle" version="@TOOL_VERSION@.0">
    <description>plot signal over time</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <expand macro="version_command" />
    <command detect_errors="aggressive"><![CDATA[
ln -s '$fast5in' input.fast5 &&

poretools squiggle
--saveas $output_format
$theme_bw
--num-facets $num_facets
input.fast5
    ]]></command>
    <inputs>
        <param name="fast5in" type="data" format="h5" label="Fast5 file" />
        <expand macro="output_format_param" />
        <expand macro="theme_bw_param" />
        <param name="num_facets" argument="--num-facets" type="integer" value="6" min="0" label="The number of plot facets (sub-plots). More is better for long reads." />
    </inputs>
    <outputs>
        <data name="squiggle_plot_png" format="png" from_work_dir="input.fast5.png" label="${tool.name} on ${on_string}: squiggle plot (png)" >
            <filter> output_format == 'png' </filter>
        </data>
        <data name="squiggle_plot_pdf" format="pdf" from_work_dir="input.fast5.pdf" label="${tool.name} on ${on_string}: squiggle plot (pdf)" >
            <filter> output_format == 'pdf' </filter>
        </data>
    </outputs>
    <tests>
        <test><!-- test with defaults -->
            <param name="fast5in" value="test.fast5" />
            <output name="squiggle_plot_png" file="squiggle_plot.png" ftype="png" compare="sim_size" />
        </test>
        <test><!-- test with defaults -->
            <param name="fast5in" value="test.fast5" />
            <param name="output_format" value="pdf" />
            <param name="num_facets" value="4" />
            <param name="theme_bw" value="--theme-bw" />
            <output name="squiggle_plot_pdf" file="squiggle_plot.pdf" ftype="pdf" compare="sim_size" />
        </test>
    </tests>
    <help><![CDATA[
@HELP_GENERAL@

**Command Documentation**

Make a “squiggle” plot of the signal over time for a given read or set of reads.

For more information about this command, see command_doc_

.. _command_doc: http://poretools.readthedocs.io/en/latest/content/examples.html#poretools-squiggle

    ]]></help>
    <expand macro="citations"/>
</tool>
